$search-width: 78%;

/* =====================================================
   DEFAULT COLOR VALUES (Can be overridden)
   ===================================================== */
$default-search-background: #f7f7f7;
$default-search-input-background: #f1f3f4;
$default-search-input-text-color: #6b6b6b;
$default-search-border-hover: #90003b;
$default-search-border-focus: #90003b;
$default-search-dropdown-background: #90003b;
$default-search-dropdown-text-color: #fff;
$default-search-highlight-bg: #fee8e8;
$default-search-heading-color: #9c9c9c;
$default-search-text-color: #333;
$default-search-icon-color: #33333380;

/* =====================================================
   HOST VARIABLES
   ===================================================== */

:host {
  --search-background: #{$default-search-background};
  --search-input-background: #{$default-search-input-background};
  --search-input-text-color: #{$default-search-input-text-color};
  --search-border-hover: #{$default-search-border-hover};
  --search-border-focus: #{$default-search-border-focus};
  --search-dropdown-background: #{$default-search-dropdown-background};
  --search-dropdown-text-color: #{$default-search-dropdown-text-color};
  --search-highlight-bg: #{$default-search-highlight-bg};
  --search-heading-color: #{$default-search-heading-color};
  --search-text-color: #{$default-search-text-color};
  --search-icon-color: #{$default-search-icon-color};

 ::ng-deep .mat-mdc-form-field {
    padding: 0;
    margin: 0 !important;

    .mat-mdc-form-field-icon-prefix { padding: 0 0.5rem 0 0.75rem; }
    .mat-mdc-form-field-icon-suffix { padding: 0 0.75rem 0 0.5rem; }
    .mat-mdc-form-field-subscript-wrapper { display: none;}
  }
}

/* =====================================================
   TOOLBAR SEARCH CONTAINER
   ===================================================== */

.toolbar-search {
  display: flex;
  align-items: center;
  width: 100%;
  max-width: 32rem;
  background-color: var(--search-background) !important;
  border-radius: 0 0 0.25rem 0.25rem;
  gap: 0;

  ::ng-deep {
    .mat-mdc-form-field .mat-mdc-text-field-wrapper {
      height: 2.5rem;
      align-items: center;
    }

    .mat-mdc-form-field-infix {
      min-height: 2.25rem;
      padding: 0.5rem 0;
    }
  }
}

/* =====================================================
   SEARCH INPUT
   ===================================================== */

.toolbar-search-input {
  width: $search-width;
  flex: 1 1 auto;
  margin-right: 0 !important;
  font-size: 0.75rem;

  ::ng-deep {
    input {
      margin: 0;
      color: var(--search-input-text-color) !important;
    }

    .mat-mdc-text-field-wrapper {
      background-color: var(--search-input-background) !important;
    }

    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
      border: none !important;
      background-color: transparent !important;
    }

    .mdc-notched-outline__leading {
      border-radius: 0.25rem 0 0 0.25rem;
    }

    .mdc-notched-outline__trailing {
      border-radius: 0;
    }
  }
}

/* =====================================================
   ICONS
   ===================================================== */

.icomoon {
  &.Search,
  &.close {
    height: 1rem;
    width: 1rem;
    font-size: 1rem;
    color: var(--search-icon-color);
    padding-bottom: 0.25rem;
  }

  &.close {
    cursor: pointer;
  }
}

/* =====================================================
   SEARCH SELECT
   ===================================================== */
$select-width: calc(100% - #{$search-width});   

.toolbar-search-select {
  flex: 1 1 auto;
  margin-left: 0 !important;
  min-width: 0;
  width: $select-width;

  ::ng-deep {
    .mat-mdc-select-value-text {
      font-size: 0.75rem;
      line-height: normal;
      white-space: nowrap;
      overflow: hidden;
      display: flex;
      max-width: 100%;
      align-items: center;
    }

    .mat-mdc-select {
      max-width: 100%;
      padding-left: 0;
      padding-right: 0;
    }

    .mat-mdc-select-value {
      display: flex;
      align-items: center;
      min-width: 0;
      flex: 1 1 auto;
    }

    .mat-mdc-form-field-text-suffix {
      display: flex;
      align-items: center;
      margin-left: 0.375rem;
      flex-shrink: 0;
    }

    .mat-mdc-select-arrow-wrapper {
      width: 1rem;
      flex-shrink: 0;
    }

    .mat-mdc-select-arrow {
      transform: rotate(0deg) scale(1.3) !important;
      
      svg {
        // Make arrow outline instead of solid
        fill: none !important;
        stroke: var(--search-icon-color);
        stroke-width: 1;
      }
    }

    .mat-mdc-text-field-wrapper {
      background-color: var(--search-input-background) !important;
    }

    .mdc-notched-outline__leading,
    .mdc-notched-outline__notch,
    .mdc-notched-outline__trailing {
      border: none !important;
      background-color: transparent !important;
    }

    .mdc-notched-outline__leading {
      border-radius: 0;
    }

    .mdc-notched-outline__trailing {
      border-radius: 0 0.25rem 0.25rem 0;
    }

    .mat-mdc-form-field-infix {
      -webkit-padding-before: 0.7em;
      padding: 0.375rem 0;
      min-height: 2.25rem;
      display: flex;
      align-items: center;
      padding-left: 0.25rem;
      padding-right: 0.25rem;
    }
  }
}

/* =====================================================
   SELECT PANEL
   ===================================================== */

::ng-deep .search-select.mat-mdc-select-panel {
  margin-top: 1.875rem;
  margin-left: 0.625rem;
}

/* =====================================================
   SEARCH CONTAINER / POPUP
   ===================================================== */

.search-container {
  position: relative;
  width: 100%;
  max-width: 32.1875rem;

  .search-popup {
    padding: 0 0.9375rem 0.9375rem;
    margin: 0;
    max-height: 80vh;
    overflow-x: hidden;
    overflow-y: auto;
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    z-index: 9999;
    background-color: #fff;
    box-shadow: 0 0.3125rem 0.25rem #0003;
    border-radius: 0 0 0.25rem 0.25rem;

    hr {
      border: 0;
      border-top: 0.0625rem solid #ebebeb;
      margin: 0;
      position: sticky;
      top: 0;
      padding-bottom: 0.9375rem;
      z-index: 1;
    }

    .search-message {
      display: inline-block;
      width: 100%;
      text-align: center;
      font-size: 1rem;
      padding-top: 0.75rem;
    }

    .search-item-info {
      color: #91263b;
      text-align: center;
      font-size: 0.75rem;
      margin-bottom: 0.9375rem;
      padding-top: 0.75rem;
    }

    ul {
      padding: 0;
      margin: 0;

      li {
        list-style: none;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        color: var(--search-text-color);

        &.suggestions {
          font-size: 0.9375rem;
          line-height: 2.25rem;
          padding: 0 0.9375rem 0 2.75rem;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          cursor: pointer;

          &:hover {
            background-color: var(--search-highlight-bg);
          }
        }
      }
    }
  }
}

/* =====================================================
   HOVER / FOCUS MIXIN
   ===================================================== */

@mixin apply-hover-focus($width, $color) {
  .toolbar-search-input.mat-mdc-form-field:not(.mat-form-field-disabled) {
    .mdc-notched-outline__leading {
      border: $width solid $color !important;
      border-right: none !important;
      border-radius: 0.25rem 0 0 0.25rem !important;
    }

    .mdc-notched-outline__notch {
      border-top: $width solid $color !important;
      border-bottom: $width solid $color !important;
      border-left: none !important;
      border-right: none !important;
    }

    .mdc-notched-outline__trailing {
      border-top: $width solid $color !important;
      border-bottom: $width solid $color !important;
      border-right: $width solid $color !important;
      border-left: none !important;
      border-radius: 0 0.25rem 0.25rem 0 !important;
    }

    input {
      color: var(--search-input-text-color) !important;
    }
  }

  .toolbar-search-select.mat-mdc-form-field:not(.mat-form-field-disabled) {
    .mat-mdc-text-field-wrapper {
      background: var(--search-dropdown-background) !important;
      border-radius: 0.25rem 0.25rem 0.25rem 0.25rem !important;
    }

    .mdc-notched-outline__leading {
      border-top: $width solid $color !important;
      border-bottom: $width solid $color !important;
      border-left: $width solid $color !important;
      border-right: none !important;
      border-radius: 0.25rem 0 0 0.25rem !important;
    }

    .mdc-notched-outline__notch {
      border-top: $width solid $color !important;
      border-bottom: $width solid $color !important;
      border-left: none !important;
      border-right: none !important;
    }

    .mdc-notched-outline__trailing {
      border-top: $width solid $color !important;
      border-bottom: $width solid $color !important;
      border-right: $width solid $color !important;
      border-left: none !important;
      border-radius: 0 0.25rem 0.25rem 0 !important;
    }

    .mat-mdc-select,
    .mat-mdc-select-value {
      color: var(--search-dropdown-text-color) !important;
    }

    .mat-mdc-select-arrow svg {
      fill: none !important;
      stroke: var(--search-dropdown-text-color) !important;
      stroke-width: 1;
    }
  }
}

/* =====================================================
   GLOBAL STATES
   ===================================================== */

::ng-deep {
  .toolbar-search {
    input {
      line-height: 0.875rem;
      color: var(--search-input-text-color) !important;
    }

    input::placeholder {
      color: var(--search-input-text-color);
      opacity: 0.6;
    }

    &:hover:not(:focus-within) {
      @include apply-hover-focus(0.0625rem, var(--search-border-hover));
    }

    &:focus-within {
      @include apply-hover-focus(0.125rem, var(--search-border-focus));
    }
  }

}